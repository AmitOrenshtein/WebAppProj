<html>
    <body>
        <form method="post" action="http://localhost:8082/products">
            <input name="name" id="inpName">
            <input type="submit">
            <button type="button" id="btnDelete">Delete</button>
        </form>

        <ul id="products"></ul>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
        <script src="https://unpkg.com/js3d"></script>
        <script>
            $(function(){
               $.ajax({
                 url:"http://localhost:8082/articles",
               }).done(function(data){
                data.forEach(product => {
                    $('#articles').append('<li>'+product.name+','+product._id+'</li>')
                });
                
               });
               $(document.forms[0]).submit(function(e){
                e.preventDefault();
               
                $.ajax({
                    type: "POST",
                    url:"http://localhost:8082/articles",
                    data: $(document.forms[0]).serialize(),
                    success: function(data){
                        $('#articles').append('<li>'+data.name+','+data._id+'</li>') 
                    }
                })
                $.ajax({
                    url: 'http://localhost:8082/products/monthly-purchases',
                  }).done(function(data) {
                    displayMonthlyPurchaseGraph(data);
                  });
               
            });

            $('#btnDelete').click(function(){
                $.ajax({
                    type:"DELETE",
                    url:"http://localhost:8082/articles/"+$('#inpTitle').val(),
                    success: function(data){
                        $('li:contains("'+$('#inpTitle').val()+'")').remove()
                    } 
                });
            });
        });

        function displayMonthlyPurchaseGraph(data) {
            const labels = data.map(entry => entry.month);
            const values = data.map(entry => entry.average);
          
            const ctx = document.getElementById('monthlyPurchaseChart').getContext('2d');
            new Chart(ctx, {
              type: 'bar',
              data: {
                labels,
                datasets: [{
                  label: 'Monthly Average Purchase',
                  data: values,
                  backgroundColor: 'rgba(75, 192, 192, 0.2)',
                  borderColor: 'rgba(75, 192, 192, 1)',
                  borderWidth: 1
                }]
              },
              options: {
                scales: {
                  y: {
                    beginAtZero: true
                  }
                }
              }
            });
          }
        </script>
        
    </body>
</html>